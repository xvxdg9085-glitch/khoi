{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}
{% block title %}
  Product List
{% endblock %}

{% block content %}
<br><br><br>
    <div class="container">
      <div class="row g-4 my-3">
            {% for product in page_obj  %}
                <div class="col-12 col-sm-6 col-md-4 col-lg-3 d-flex">
                    <div class="card shadow-sm w-100 h-100" data-aos="fade-up" data-aos-delay="100">
                    <!-- Hình ảnh sản phẩm -->
                    {% if product.main_image %}
                        <div class="ratio ratio-1x1">
                        <img
                            src="{{ product.main_image.url }}"
                            class="card-img-top object-fit-cover"
                            alt="{{ product.name }}"
                        />
                        </div>
                    {% else %}
                        <div class="ratio ratio-1x1 bg-light d-flex align-items-center justify-content-center">
                        <span class="text-muted">No Image</span>
                        </div>
                    {% endif %}

                    <!-- Thông tin sản phẩm -->
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title fw-bold" style="font-size: 18px">{{ product.name }}</h5>
                        <div class="mb-3">
                        {% if product.discount %}
                            <div class="fw-bold text-success fs-5-5">{{ product.discounted_price|currency }} <span class="badge bg-success">-{{ product.discount }}%</span></div>
                            <div class="text-muted text-decoration-line-through">{{ product.price|currency }}</div>
                            
                        {% else %}
                            <div class="fw-bold text-success">{{ product.price|currency }}</div>
                        {% endif %}
                        </div>

                        <div class="mt-auto">
                         <a href="{% url 'product_detail' product.id %}" class="btn btn-outline-primary btn-sm w-100"> 
                        
                            View Details
                        </a>
                        </div>
                    </div>
                    </div>
                </div>
                {% empty %}
                  <p class="text-center text-muted">No products found.</p>
                {% endfor %}
      </div>
      {% include "partials/pagination.html" %}
    </div>

  <!-- Kích hoạt popover -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const popoverTriggerList = document.querySelectorAll('[data-bs-toggle="popover"]')
      ;[...popoverTriggerList].map((popoverTriggerEl) => new bootstrap.Popover(popoverTriggerEl))
    })
  </script>
{% endblock %}